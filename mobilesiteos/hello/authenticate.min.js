(function(_1,_2){"use strict";var _3="",_4=_1.utils,_5=_2.opener||_2.parent,_6=_2.location,_7=function(_8){if(_6.assign){_6.assign(_8);}else{_6.href=_8;}},p={},a;_2.name=_2.name||"child_"+parseInt(Math.random()*1000000000000,10).toString(36);_3=_2.name+" - authenticating 8==> ";msos.console.debug(_3+"start, location: "+_6);function _9(){try{_2.close();}catch(e){msos.console.warn(_3+"closeWindow: failed!");}if(_2.addEventListener){_2.addEventListener("load",function(){_2.close();});}};function _a(_b,_c){var _d="auth_cb -> ",cb;msos.console.debug(_3+_d+"start.");_4.store(_c.network,_c);if(!(p.display)||p.display!=="page"){if(_5){cb=_c.callback;delete _c.callback;msos.console.debug(_3+_d+"callback: "+cb);try{_5[cb](_c);}catch(e){msos.console.error(_3+_d+"callback: "+cb+", failed: ",e);}_4.store(_c.network,_c);}else{msos.console.warn(_3+_d+"no parent.");}_9();}else{msos.console.debug(_3+_d+"skipped page.");}msos.console.debug(_3+_d+"done!");};p=_4.merge(_4.param(_6.search||""),_4.param(_6.hash||""));if(p&&p.state){try{a=JSON.parse(p.state);p=_4.merge(p,a);}catch(e){_1.emit("error",{error:{code:"decode_state",message:e.message}});}if(p.access_token&&p.network){if(!p.expires_in||parseInt(p.expires_in,10)===0){p.expires_in=0;}p.expires_in=parseInt(p.expires_in,10);p.expires=((new Date()).getTime()/1000)+(p.expires_in||(60*60*24*365));_1.service(p.network);_a(p.network,p);}else{if(p.error&&p.network){p.error={code:p.error,message:p.error_message||p.error_description};_a(p.network,p);}}if(p&&p.callback&&p.result){if(_2.parent[p.callback]){_2.parent[p.callback](JSON.parse(p.result));}}}else{if(p&&p.oauth_redirect){_7(decodeURIComponent(p.oauth_redirect));}else{msos.console.warn(_3+"no query returned.");}}msos.console.debug(_3+"done, window: "+_2.name);}(hello,window));